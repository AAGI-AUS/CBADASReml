<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-AU">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Small-plot analysis • CBADASReml</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Small-plot analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CBADASReml</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/small_plot_analysis.html">Small-plot analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Small-plot analysis</h1>
            
      

      <div class="d-none name"><code>small_plot_analysis.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aagi-aus.github.io/CBADASReml/">CBADASReml</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">asreml</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="cbadasreml">CBADASReml<a class="anchor" aria-label="anchor" href="#cbadasreml"></a>
</h2>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>A typical type of experimental analysis that this package will assist
with is the small plot trial. Here we will show the general workflow for
performing a small-plot analysis and how each function from the package
can be used. Analysis of small plot trials is done using linear
mixed-effects models (LMMs), using <code>ASReml</code> or
<code>glmmTMB</code>, and this package contains helper functions for
this type of modelling.</p>
<p>Note that the trial design is not handled at all by this package, and
we recommend the use of <code>FielDHub</code> for creating small plot
trial designs.</p>
</div>
<div class="section level3">
<h3 id="mathematical-background">Mathematical Background<a class="anchor" aria-label="anchor" href="#mathematical-background"></a>
</h3>
<p>Let:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>X</mi><mi>b</mi><mo>+</mo><mi>Z</mi><mi>u</mi><mo>+</mo><mi>e</mi></mrow><annotation encoding="application/x-tex">\begin{equation*}
y
=
X b
+
Z u
+
e
\end{equation*}</annotation></semantics></math></p>
<p>Where</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∈</mo><msup><mi>ℝ</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">y \in \mathbb{R}^{n}</annotation></semantics></math>
is the vector of observations.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>∈</mo><msup><mi>ℝ</mi><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">b \in \mathbb{R}^{p}</annotation></semantics></math>
is the vector of fixed effects.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>n</mi><mo>×</mo><mi>p</mi></mrow></msup></mrow><annotation encoding="application/x-tex">X \in \mathbb{R}^{n \times p}</annotation></semantics></math>
is the design matrix for the fixed effects.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>∈</mo><msup><mi>ℝ</mi><mi>q</mi></msup></mrow><annotation encoding="application/x-tex">u \in \mathbb{R}^{q}</annotation></semantics></math>
is the vector of random effects.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>n</mi><mo>×</mo><mi>q</mi></mrow></msup></mrow><annotation encoding="application/x-tex">Z \in \mathbb{R}^{n \times q}</annotation></semantics></math>
is the design matrix for the random effects.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>∈</mo><msup><mi>ℝ</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">e \in \mathbb{R}^{n}</annotation></semantics></math>
is the vector of residuals.</li>
</ul>
<p>It is assumed that the vectors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>e</mi><annotation encoding="application/x-tex">e</annotation></semantics></math>
are independent, and their joint distribution is a multivariate Gaussian
described by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>u</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>e</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>∼</mo><mi>N</mi><mo minsize="240%" maxsize="240%" stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>G</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo minsize="240%" maxsize="240%" stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
\begin{bmatrix}
u \\
e
\end{bmatrix}
\sim
N \bigg(
  \begin{bmatrix}
  0 \\
  0
  \end{bmatrix}
  ,
  \begin{bmatrix}
  G &amp; 0 \\
  0 &amp; R
  \end{bmatrix}
\bigg)
\end{equation*}</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
are covariance matrices for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>e</mi><annotation encoding="application/x-tex">e</annotation></semantics></math>
and are functions of the <em>variance parameters</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>g</mi></msub><annotation encoding="application/x-tex">\sigma_g</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\sigma_r</annotation></semantics></math>,
and finally the dependent variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
is described by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∼</mo><mi>N</mi><mo minsize="120%" maxsize="120%" stretchy="true" form="prefix">(</mo><mi>X</mi><mi>b</mi><mo>,</mo><mi>Z</mi><mi>G</mi><msup><mi>Z</mi><mo>⊺</mo></msup><mo>+</mo><mi>R</mi><mo minsize="120%" maxsize="120%" stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
y
\sim
N \big(
X b
,
Z G Z^\intercal
+
R
\big)
\end{equation*}</annotation></semantics></math></p>
<p>These
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
covariance matrices, or <em>covariance structures</em>, are very
important. These represent the way the random effects and the residuals
behave, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>g</mi></msub><annotation encoding="application/x-tex">\sigma_g</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\sigma_r</annotation></semantics></math>,
the <em>covariance structure parameters</em> are the things we try and
estimate when we use ASReml.</p>
<p>In the case of independent and identically distributed (IID) residual
structures, the residual covariance parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\sigma_r</annotation></semantics></math>
will be some <em>variance component</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_e^2</annotation></semantics></math>.</p>
<div class="section level4">
<h4 id="exploratory-data-analysis">Exploratory Data Analysis<a class="anchor" aria-label="anchor" href="#exploratory-data-analysis"></a>
</h4>
<p>After gathering data from an experiment, it is useful to perform an
exploratory data analysis on the raw data, and for this you will likely
use a combination of <code>tidyverse</code> and <code>gplot2</code> for
this, to visualise outliers, the data distribution, etc. in order to get
a preliminary grasp of what you are working with, and to observe the
data for any issues that will hinder the actual analysis. As an
assistance with this process, the function
<code>exploratory_table</code> is provided.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CBADASReml</span><span class="fu">::</span><span class="fu"><a href="../reference/exploratory_table.html">exploratory_table</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">oats</span>,</span>
<span>    response <span class="op">=</span> <span class="st">"yield"</span>,</span>
<span>    groupby <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Variety"</span>, <span class="st">"Nitrogen"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;        Variety Nitrogen             mean median               sd</span></span>
<span><span class="co">#&gt; 1  Golden_rain    0_cwt               80     75 21.0047613649858</span></span>
<span><span class="co">#&gt; 2  Golden_rain  0.2_cwt             98.5  102.5 13.4721935853075</span></span>
<span><span class="co">#&gt; 3  Golden_rain  0.4_cwt 114.666666666667    110 29.9443929086343</span></span>
<span><span class="co">#&gt; 4  Golden_rain  0.6_cwt 124.833333333333  129.5 20.8750249500849</span></span>
<span><span class="co">#&gt; 5   Marvellous    0_cwt 86.6666666666667   92.5 16.5730705262081</span></span>
<span><span class="co">#&gt; 6   Marvellous  0.2_cwt            108.5  111.5 26.8533051969399</span></span>
<span><span class="co">#&gt; 7   Marvellous  0.4_cwt 117.166666666667  118.5 9.78604448521805</span></span>
<span><span class="co">#&gt; 8   Marvellous  0.6_cwt 126.833333333333  122.5 20.2920345620311</span></span>
<span><span class="co">#&gt; 9      Victory    0_cwt             71.5     65   20.59854363784</span></span>
<span><span class="co">#&gt; 10     Victory  0.2_cwt 89.6666666666667   89.5 22.5092573548455</span></span>
<span><span class="co">#&gt; 11     Victory  0.4_cwt 110.833333333333    106 26.0108951531213</span></span>
<span><span class="co">#&gt; 12     Victory  0.6_cwt            118.5  114.5 30.0915270466622</span></span>
<span><span class="co">#&gt;                  cv reps min max     range</span></span>
<span><span class="co">#&gt; 1  26.2559517062322    6  60 117  60 - 117</span></span>
<span><span class="co">#&gt; 2  13.6773538937132    6  82 114  82 - 114</span></span>
<span><span class="co">#&gt; 3  26.1142961412508    6  86 161  86 - 161</span></span>
<span><span class="co">#&gt; 4  16.7223163819105    6  96 149  96 - 149</span></span>
<span><span class="co">#&gt; 5  19.1227736840862    6  63 105  63 - 105</span></span>
<span><span class="co">#&gt; 6  24.7495900432626    6  70 140  70 - 140</span></span>
<span><span class="co">#&gt; 7  8.35224280388454    6 104 132 104 - 132</span></span>
<span><span class="co">#&gt; 8  15.9989760016014    6  99 156  99 - 156</span></span>
<span><span class="co">#&gt; 9   28.809151941035    6  53 111  53 - 111</span></span>
<span><span class="co">#&gt; 10  25.103260990534    6  64 130  64 - 130</span></span>
<span><span class="co">#&gt; 11 23.4684768298838    6  81 157  81 - 157</span></span>
<span><span class="co">#&gt; 12 25.3936937102634    6  86 174  86 - 174</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-fitting-and-validation">Model Fitting and Validation<a class="anchor" aria-label="anchor" href="#model-fitting-and-validation"></a>
</h4>
<p>We may use the R package <code>asreml</code> as follows to implement
an LMM. For the purpose of this vignette we will fit a few different
models, so we can demonstrate different techniques from the package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The needs to be ordered so that the model can run</span></span>
<span><span class="va">oats</span> <span class="op">&lt;-</span> <span class="va">oats</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">oats</span><span class="op">$</span><span class="va">Column</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">mod_oats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">yield</span> <span class="op">~</span> <span class="va">Variety</span> <span class="op">+</span> <span class="va">Nitrogen</span> <span class="op">+</span> <span class="va">Variety</span><span class="op">:</span><span class="va">Nitrogen</span>,</span>
<span>    random <span class="op">=</span> <span class="op">~</span> <span class="fu">idv</span><span class="op">(</span><span class="va">Blocks</span><span class="op">)</span> <span class="op">+</span> <span class="fu">idv</span><span class="op">(</span><span class="va">Blocks</span><span class="op">)</span><span class="op">:</span><span class="fu">id</span><span class="op">(</span><span class="va">Wplots</span><span class="op">)</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">Column</span><span class="op">)</span><span class="op">:</span><span class="fu">ar1</span><span class="op">(</span><span class="va">Row</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">oats</span>,</span>
<span>    trace <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in asreml(fixed = yield ~ Variety + Nitrogen + Variety:Nitrogen, : Some</span></span>
<span><span class="co">#&gt; components changed by more than 1% on the last iteration</span></span>
<span></span>
<span><span class="va">mod_oats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod_oats</span>, aom <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_rats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">weight</span> <span class="op">~</span> <span class="va">littersize</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">Dose</span>,</span>
<span>    random <span class="op">=</span> <span class="op">~</span><span class="fu">idv</span><span class="op">(</span><span class="va">Dam</span><span class="op">)</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span><span class="va">units</span>,</span>
<span>    data <span class="op">=</span> <span class="va">rats</span>,</span>
<span>    trace <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_rats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod_rats</span>, aom <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>In the first model, <code>mod_oats</code>, we are using the
<code>oats</code> data:</p>
<div class="section level6">
<h6 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h6>
<ul>
<li>The <code>oats</code> data has 72 rows, 2 treatments (Nitrogen and
Variety), and plots (3 levels) within blocks (6 levels). Therefore:
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>72</mn></mrow><annotation encoding="application/x-tex">n = 72</annotation></semantics></math>
(number of observations)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">p = 3</annotation></semantics></math>
(number of fixed effects, including an interaction effect)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">q = 2</annotation></semantics></math>
(number of random effects, blocks, and plots within blocks)</li>
</ul>
</li>
</ul>
</div>
<div class="section level6">
<h6 id="y">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#y"></a>
</h6>
<ul>
<li>
<code>yield</code> is our
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∈</mo><msup><mi>ℝ</mi><mn>72</mn></msup></mrow><annotation encoding="application/x-tex">y \in \mathbb{R}^{72}</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>72</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">72 \times 1</annotation></semantics></math>)
vector.</li>
</ul>
</div>
<div class="section level6">
<h6 id="x">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#x"></a>
</h6>
<ul>
<li>
<code>Variety</code>, <code>Nitrogen</code> and their interaction
<code>Variety:Nitrogen</code> are in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∈</mo><msup><mi>ℝ</mi><mrow><mn>72</mn><mo>×</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">X
\in \mathbb{R}^{72 \times 3}</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>72</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">72 \times 3</annotation></semantics></math>)
matrix.</li>
</ul>
</div>
<div class="section level6">
<h6 id="b">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#b"></a>
</h6>
<ul>
<li>There are 3 fixed effects which are continuous, therefore our fixed
effects vector is given by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>∈</mo><msup><mi>ℝ</mi><mrow><mn>3</mn><mo>×</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">b \in \mathbb{R}^{3 \times 1}</annotation></semantics></math>
</li>
</ul>
</div>
<div class="section level6">
<h6 id="z">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#z"></a>
</h6>
<ul>
<li>
<code>Blocks</code> and <code>Blocks:Wplots</code> make up our
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>n</mi><mo>×</mo><mi>q</mi></mrow></msup></mrow><annotation encoding="application/x-tex">Z \in \mathbb{R}^{n \times q}</annotation></semantics></math>
matrix. Since these are factors, each level is treated as it’s own dummy
variable. We end up with two
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Z_i</annotation></semantics></math>
matrices which make up
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mo stretchy="false" form="prefix">[</mo><mspace width="0.278em"></mspace><msub><mi>Z</mi><mn>1</mn></msub><mspace width="0.278em"></mspace><msub><mi>Z</mi><mn>2</mn></msub><mspace width="0.278em"></mspace><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">Z = [ \; Z_1 \; Z_2
\; ]</annotation></semantics></math> which are given as follows (if
ordered by their respective variables):</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi><mo>×</mo><mtext mathvariant="normal">10</mtext></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi><mo>×</mo><mtext mathvariant="normal">11</mtext></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mn>72</mn><mo>×</mo><mn>6</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\begin{equation*}
Z_{1}
=
\begin{bmatrix}
1          &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\vdots \times \text{10} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1          &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0          &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0          &amp; \vdots \times \text{11} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
           &amp;   &amp; \vdots &amp;   &amp;   &amp;
\end{bmatrix}
\in
\mathbb{R}^{72 \times 6}
\end{equation*}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>2</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi><mo>×</mo><mtext mathvariant="normal">2</mtext></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi><mo>×</mo><mtext mathvariant="normal">2</mtext></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mn>72</mn><mo>×</mo><mn>18</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\begin{equation*}
Z_{2}
=
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\vdots \times \text{2} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \vdots \times \text{2} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
&amp;  &amp;  &amp;  &amp;  &amp;  &amp;  &amp;  &amp; \vdots &amp;  &amp;  &amp;  &amp;  &amp;  &amp;  &amp;  &amp;  &amp;
\end{bmatrix}
\in
\mathbb{R}^{72 \times 18}
\end{equation*}</annotation></semantics></math></p>
<p>Where each column in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Z_1</annotation></semantics></math>
represents the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>6</mn><annotation encoding="application/x-tex">6</annotation></semantics></math><code>Blocks</code>, and the columns in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Z_2</annotation></semantics></math>
represent the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mo>×</mo><mn>3</mn><mo>=</mo><mn>18</mn></mrow><annotation encoding="application/x-tex">6 \times 3 = 18</annotation></semantics></math><code>Blocks</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>×</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math><code>Wplots</code>.</p>
</div>
<div class="section level6">
<h6 id="u">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#u"></a>
</h6>
<ul>
<li>Since we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>
model terms (<code>idv(Blocks)</code> and
<code>idv(Blocks):id(Wplots)</code>), we have two
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Z_i</annotation></semantics></math>
matrices, and also two
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>i</mi></msub><annotation encoding="application/x-tex">u_i</annotation></semantics></math>
vectors. Our random effects vector is given by:
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">u = \begin{bmatrix} u_1 \\ u_2 \end{bmatrix}</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo>∼</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>G</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>∈</mo><msup><mi>ℝ</mi><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">u_1 \sim N(0, G_1) \in \mathbb{R}^{6}</annotation></semantics></math></li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub><mo>∼</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>G</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>∈</mo><msup><mi>ℝ</mi><mn>18</mn></msup></mrow><annotation encoding="application/x-tex">u_2 \sim N(0, G_2) \in \mathbb{R}^{18}</annotation></semantics></math>.</li>
</ul>
</li>
</ul>
</div>
<div class="section level6">
<h6 id="g">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#g"></a>
</h6>
<ul>
<li>
<code>idv(Blocks) + idv(Blocks):id(Wplots)</code> is the random
effects variance structure. Since we have two terms, we again have two
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mi>i</mi></msub><annotation encoding="application/x-tex">G_i</annotation></semantics></math>’s.
We specify the <code>idv</code> variance model function, which is the
homogeneous scaled identity variance structure,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mi>I</mi></mrow><annotation encoding="application/x-tex">\sigma^2 I</annotation></semantics></math>.
The second term has a /direct product/ implied by the <code>:</code>
operator, which in the case of matrices is a /Kronecker product/, of
<code>idv(Blocks)</code> and <code>id(Wplots)</code>. <code>id</code>
variance model means it is simply a correlation structure,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>,
and there is no estimation of a variance parameter. Noting we have 2
random effects terms:
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><msub><mi>I</mi><mn>6</mn></msub></mrow><annotation encoding="application/x-tex">G_1 = \sigma_1^2 I_6</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mn>6</mn></msub><annotation encoding="application/x-tex">I_6</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">6 \times 6</annotation></semantics></math>
identity matrix)</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup><msub><mi>I</mi><mn>6</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>⊗</mo><msub><mi>I</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">G_2 = (\sigma_2^2 I_6) \otimes I_3</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><msubsup><mo>⨁</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></msubsup><msub><mi>G</mi><mi>i</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><msub><mi>I</mi><mn>6</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo stretchy="false" form="prefix">(</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup><msub><mi>I</mi><mn>6</mn></msub><mo>⊗</mo><msub><mi>I</mi><mn>3</mn></msub><mo stretchy="false" form="postfix">)</mo></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">G = \bigoplus_{i = 1}^2 G_i = \begin{bmatrix} \sigma_1^2 I_6 &amp; 0 \\ 0 &amp;
(\sigma_2^2 I_6 \otimes I_3) \end{bmatrix}</annotation></semantics></math></li>
</ul>
</li>
</ul>
</div>
<div class="section level6">
<h6 id="e">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>e</mi><annotation encoding="application/x-tex">e</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#e"></a>
</h6>
<ul>
<li>The error vector is specified by the single model term
<code>ar1(Column):ar1(Row)</code>, therefore the error is given by:
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>∼</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">e \sim N(0, R)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
structure</li>
</ul>
</li>
</ul>
</div>
<div class="section level6">
<h6 id="r">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#r"></a>
</h6>
<ul>
<li>
<code>ar1(Column):ar1(Row)</code> specifies the residual variance
structure. In this case we refer to an autoregressive model of order 1
(AR(1)) on both <code>Row</code> and <code>Column</code>, where the
<code>:</code> operator implies a separable Kronecker product structure.
The variance model <code>ar1</code> is of the form:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi mathvariant="normal">Σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>ϕ</mi><msub><mi mathvariant="normal">Σ</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi></mrow></msub><mo>,</mo><mi>i</mi><mo>&gt;</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo>,</mo><mo stretchy="false" form="prefix">|</mo><mi>ϕ</mi><mo stretchy="false" form="postfix">|</mo><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\Sigma_{ii} = 1,
\Sigma_{ij} = \phi \Sigma_{i-1, j}, i &gt; j+1, \lvert \phi \rvert &lt; 1</annotation></semantics></math>.
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><msub><mi mathvariant="normal">Σ</mi><mi>c</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>ϕ</mi><mi>c</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>⊗</mo><msub><mi mathvariant="normal">Σ</mi><mi>r</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>ϕ</mi><mi>r</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">R = \Sigma_c(\phi_c) \otimes \Sigma_r(\phi_r)</annotation></semantics></math></li>
<li>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
refers to the correlation within the columns
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mi>c</mi></msub><annotation encoding="application/x-tex">\phi_c</annotation></semantics></math>)
or the rows
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\phi_r</annotation></semantics></math>).</li>
</ul>
</li>
</ul>
<p>In the second model, <code>mod_rats</code>, we are using the
<code>rats</code> data:</p>
<ul>
<li>
<code>weight</code> is our
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
vector.</li>
<li>
<code>littersize</code>, <code>Sex</code> and <code>Dose</code> are
in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
matrix.</li>
<li>
<code>Dam</code> is in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
matrix. We specify the <code>idv</code> variance model function, which
is the homogeneous scaled identity variance structure,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mi>I</mi></mrow><annotation encoding="application/x-tex">\sigma^2
I</annotation></semantics></math>. In other words, the term is IID:
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>∈</mo><msup><mi>ℝ</mi><mi>d</mi></msup><mo>∼</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>G</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">u \in \mathbb{R}^d \sim N(0, G)</annotation></semantics></math></li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
is the design matrix for <code>Dam</code>.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><msubsup><mi>σ</mi><mi>d</mi><mn>2</mn></msubsup><msub><mi>I</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">G = \sigma_d^2 I_d</annotation></semantics></math>.</li>
</ul>
</li>
<li>
<code>idv(units)</code> is the residual variance structure, in this
case the residual term has the homogeneous covariance matrix:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mi>I</mi></mrow><annotation encoding="application/x-tex">\sigma^2 I</annotation></semantics></math>.
This is basically saying all observations have the same error
distribution (IID):
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>∈</mo><msup><mi>ℝ</mi><mi>n</mi></msup><mo>∼</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">e \in \mathbb{R}^n \sim N(0, R)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><msub><mi>I</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">R = \sigma_e^2 I_n</annotation></semantics></math></li>
</ul>
</li>
</ul>
<p>Upon executing the above in R, the <code>ASReml-R</code> code will
attempt to <em>estimate</em> the variance components
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>d</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_d^2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_e^2</annotation></semantics></math>,
using the REML algorithm.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="function-examples">Function examples<a class="anchor" aria-label="anchor" href="#function-examples"></a>
</h3>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px">
<div class="section level4">
<h4 id="traditional-diagnostics-asreml-r">Traditional Diagnostics (<code>ASReml-R</code>)<a class="anchor" aria-label="anchor" href="#traditional-diagnostics-asreml-r"></a>
</h4>
<div class="section level5">
<h5 id="plot-asreml">
<code>plot.asreml</code><a class="anchor" aria-label="anchor" href="#plot-asreml"></a>
</h5>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_oats</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4"><div class="figcaption">plot of chunk unnamed-chunk-4</div>
</div>
</div>
<div class="section level5">
<h5 id="plotvariogrammod">
<code>plot(varioGram(mod))</code><a class="anchor" aria-label="anchor" href="#plotvariogrammod"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/varioGram.html" class="external-link">varioGram</a></span><span class="op">(</span><span class="va">mod_oats</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-5-1.png" alt="plot of chunk unnamed-chunk-5"><div class="figcaption">plot of chunk unnamed-chunk-5</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="cbadasreml-diagnostics">CBADASReml Diagnostics<a class="anchor" aria-label="anchor" href="#cbadasreml-diagnostics"></a>
</h4>
<div class="section level5">
<h5 id="outlier_summary">
<code>outlier_summary</code><a class="anchor" aria-label="anchor" href="#outlier_summary"></a>
</h5>
<p>The purpose of the <code>outlier_summary</code> function is to
observe potential outliers that can then be discussed with the data
provider. Below is an example for the rats dataset that is included
within <code>ASReml-R</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/outlier_summary.html">outlier_summary</a></span><span class="op">(</span><span class="va">mod_rats</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Outliers detected: 2"</span></span>
<span><span class="co">#&gt;    Dose Sex littersize Dam weight units combined_trt residuals</span></span>
<span><span class="co">#&gt; 56    C   F         13   5   5.02    56       13_F_C -4.090506</span></span>
<span><span class="co">#&gt; 66    C   F          9   6   3.68    66        9_F_C -7.941340</span></span>
<span><span class="co">#&gt;     Dose Sex littersize Dam weight units combined_trt  residuals</span></span>
<span><span class="co">#&gt; 56     C   F         13   5   5.02    56       13_F_C -4.0905065</span></span>
<span><span class="co">#&gt; 57     C   F         13   5   6.04    57       13_F_C -1.4769901</span></span>
<span><span class="co">#&gt; 53     C   F         13   5   7.16    53       13_F_C  1.3927533</span></span>
<span><span class="co">#&gt; 55     C   F         13   5   7.14    55       13_F_C  1.3415079</span></span>
<span><span class="co">#&gt; 54     C   F         13   5   7.09    54       13_F_C  1.2133944</span></span>
<span><span class="co">#&gt; 129    C   F         13  10   5.92   129       13_F_C -1.1145276</span></span>
<span><span class="co">#&gt; 126    C   F         13  10   6.67   126       13_F_C  0.8050510</span></span>
<span><span class="co">#&gt; 128    C   F         13  10   6.53   128       13_F_C  0.4467297</span></span>
<span><span class="co">#&gt; 130    C   F         13  10   6.52   130       13_F_C  0.4211353</span></span>
<span><span class="co">#&gt; 125    C   F         13  10   6.44   125       13_F_C  0.2163802</span></span>
<span><span class="co">#&gt; 131    C   F         13  10   6.44   131       13_F_C  0.2163802</span></span>
<span><span class="co">#&gt; 127    C   F         13  10   6.43   127       13_F_C  0.1907859</span></span>
<span><span class="co">#&gt; 66     C   F          9   6   3.68    66        9_F_C -7.9413397</span></span>
<span><span class="co">#&gt; 64     C   F          9   6   7.26    64        9_F_C  1.3727706</span></span>
<span><span class="co">#&gt; 65     C   F          9   6   6.58    65        9_F_C -0.3963900</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="directional_variograms">
<code>directional_variograms</code><a class="anchor" aria-label="anchor" href="#directional_variograms"></a>
</h5>
<p>The purpose of this function is to view the autocorrelation structure
in both directions, rather than the traditional approach with
<code>ASReml-R</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/directional_variograms.html">directional_variograms</a></span><span class="op">(</span><span class="va">mod_oats</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-7-1.png" alt="plot of chunk unnamed-chunk-7"><div class="figcaption">plot of chunk unnamed-chunk-7</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="model-outputs">Model Outputs<a class="anchor" aria-label="anchor" href="#model-outputs"></a>
</h3>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px">
<div class="section level4">
<h4 id="traditional-outputs-asreml-r">Traditional Outputs (<code>ASReml-R</code>)<a class="anchor" aria-label="anchor" href="#traditional-outputs-asreml-r"></a>
</h4>
<div class="section level5">
<h5 id="wald">
<code>wald</code><a class="anchor" aria-label="anchor" href="#wald"></a>
</h5>
<p>For getting the significance of each variable in the model</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/wald.html" class="external-link">wald</a></span><span class="op">(</span><span class="va">mod_rats</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">Wald tests for fixed effects.</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">Response: weight</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">Terms added sequentially; adjusted for those above.</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               Df Sum of Sq Wald statistic             Pr(Chisq)    </span></span>
<span><span class="co">#&gt; (Intercept)    1   1477.67         8981.5 &lt; 0.00000000000000022 ***</span></span>
<span><span class="co">#&gt; littersize     1      4.58           27.8   0.00000013118965070 ***</span></span>
<span><span class="co">#&gt; Sex            1      9.80           59.5   0.00000000000001199 ***</span></span>
<span><span class="co">#&gt; Dose           2      3.76           22.8   0.00001099619080491 ***</span></span>
<span><span class="co">#&gt; residual (MS)         0.16                                         </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="predict">
<code>predict</code><a class="anchor" aria-label="anchor" href="#predict"></a>
</h5>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/predict.asreml.html" class="external-link">predict.asreml</a></span><span class="op">(</span><span class="va">mod_oats</span>, classify <span class="op">=</span> <span class="st">"Nitrogen"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $pvals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">- The predictions are obtained by averaging across the hypertable</span></span></span>
<span><span class="co"><span style="color: #0000BB;">#&gt;   calculated from model terms constructed solely from factors in</span></span></span>
<span><span class="co"><span style="color: #0000BB;">#&gt;   the averaging and classify sets.</span></span></span>
<span><span class="co"><span style="color: #0000BB;">#&gt; - Use 'average' to move ignored factors into the averaging set.</span></span></span>
<span><span class="co"><span style="color: #0000BB;">#&gt; - The simple averaging set: Variety</span></span></span>
<span><span class="co"><span style="color: #0000BB;">#&gt; - The ignored set: Blocks,Wplots</span></span></span>
<span><span class="co"><span style="color: #0000BB;">#&gt; </span></span></span>
<span><span class="co">#&gt;   Nitrogen predicted.value std.error    status</span></span>
<span><span class="co">#&gt; 1    0_cwt        77.76388  6.929776 Estimable</span></span>
<span><span class="co">#&gt; 2  0.2_cwt       100.15097  6.896569 Estimable</span></span>
<span><span class="co">#&gt; 3  0.4_cwt       114.41044  6.887489 Estimable</span></span>
<span><span class="co">#&gt; 4  0.6_cwt       123.22901  6.912904 Estimable</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $avsed</span></span>
<span><span class="co">#&gt;  overall </span></span>
<span><span class="co">#&gt; 3.748427</span></span></code></pre></div>
</div>
</div>
<div>
<div class="section level4">
<h4 id="cbadasreml-outputs">CBADASReml Outputs<a class="anchor" aria-label="anchor" href="#cbadasreml-outputs"></a>
</h4>
</div>
<div class="section level4">
<h4 id="anova_table">
<code>anova_table</code><a class="anchor" aria-label="anchor" href="#anova_table"></a>
</h4>
<p>Show an ANOVA table for multiple models, with p-values for each
effect against each response.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rats</span><span class="op">[[</span><span class="st">"newresp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">rats</span><span class="op">[[</span><span class="st">"weight"</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">rats</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_rats2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">newresp</span> <span class="op">~</span> <span class="va">littersize</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">Dose</span>,</span>
<span>    random <span class="op">=</span> <span class="op">~</span><span class="fu">idv</span><span class="op">(</span><span class="va">Dam</span><span class="op">)</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span><span class="va">units</span>,</span>
<span>    data <span class="op">=</span> <span class="va">rats</span>,</span>
<span>    trace <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_rats2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod_rats2</span>, aom <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/anova_table.html">anova_table</a></span><span class="op">(</span><span class="va">mod_rats</span>, <span class="va">mod_rats2</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Effect weight newresp</span></span>
<span><span class="co">#&gt; 1 littersize      0   0.187</span></span>
<span><span class="co">#&gt; 2        Sex      0   0.752</span></span>
<span><span class="co">#&gt; 3       Dose      0   0.715</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="pred_table">
<code>pred_table</code><a class="anchor" aria-label="anchor" href="#pred_table"></a>
</h4>
<p>Get the mean for each level of a fixed effect, as well as standard
error, and confidence intervals.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pred_table.html">pred_table</a></span><span class="op">(</span><span class="va">mod_rats</span>, classify <span class="op">=</span> <span class="st">"Dose"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in asremlPlus::predictPlus.asreml(mod, classify = classify, wald.tab =</span></span>
<span><span class="co">#&gt; as.data.frame(asreml::wald(mod)), : Denominator degrees of freedom obtained</span></span>
<span><span class="co">#&gt; using dDF.na method residual</span></span>
<span><span class="co">#&gt;   Treatment     Mean Standard Error Lower CL Upper CL</span></span>
<span><span class="co">#&gt; 1         C 6.410370      0.1060763 6.201667 6.619072</span></span>
<span><span class="co">#&gt; 2      High 5.554064      0.1482309 5.262423 5.845704</span></span>
<span><span class="co">#&gt; 3       Low 5.989315      0.1071587 5.778483 6.200147</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="least-significant-difference">Least significant difference<a class="anchor" aria-label="anchor" href="#least-significant-difference"></a>
</h3>
<div class="section level5">
<h5 id="lsd_table">
<code>lsd_table</code><a class="anchor" aria-label="anchor" href="#lsd_table"></a>
</h5>
<p>Show a least significant difference table:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lsd_table.html">lsd_table</a></span><span class="op">(</span><span class="va">mod_rats</span>, classify <span class="op">=</span> <span class="st">"Dose"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   treatment group      lsd    means</span></span>
<span><span class="co">#&gt; 1         C     a 0.354997 6.410370</span></span>
<span><span class="co">#&gt; 2       Low     b 0.354997 5.989315</span></span>
<span><span class="co">#&gt; 3      High     c 0.354997 5.554064</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="lsd_graph">
<code>lsd_graph</code><a class="anchor" aria-label="anchor" href="#lsd_graph"></a>
</h5>
<p>Show an LSD graph of the same data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lsd_graph.html">lsd_graph</a></span><span class="op">(</span><span class="va">mod_rats</span>, classify <span class="op">=</span> <span class="st">"Dose"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-13-1.png" alt="plot of chunk unnamed-chunk-13"><div class="figcaption">plot of chunk unnamed-chunk-13</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kai Bagley, Jordan <a href="mailto:jordan.brown@curtin.edu.au" class="email">jordan.brown@curtin.edu.au</a> Brown, Adam H. <a href="mailto:adamhsparks@gmail.com" class="email">adamhsparks@gmail.com</a> Sparks, Curtin University of Technology, Grains Research and Development Corporation.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
